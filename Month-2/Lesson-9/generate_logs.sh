#!/bin/bash
NGINX_URL="http://localhost:8081"    # –∞–¥—Ä–µ—Å —Ç–≤–æ–µ–≥–æ Nginx
INTERVAL=1                      # –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (—Å–µ–∫)
REQUESTS=100                    # —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

# –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö URL
URLS=(
    "/"
    "/index.html"
    "/api/status"
    "/api/data?id=42"
    "/login"
    "/static/css/style.css"
    "/images/logo.png"
    "/docs/manual.pdf"
)

# –°–ø–∏—Å–æ–∫ "—Ñ–µ–π–∫–æ–≤—ã—Ö" IP –¥–ª—è X-Forwarded-For
IPS=(
    "192.168.1.10"
    "10.0.0.25"
    "172.16.5.3"
    "185.22.45.101"
    "77.88.55.22"
    "93.184.216.34"
    "203.0.113.50"
    "198.51.100.77"
)

# –ò—Å–ø–æ–ª—å–∑—É–µ–º trap –¥–ª—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞
trap 'echo "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞..."; exit 0' INT TERM

echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ $NGINX_URL ($REQUESTS –∑–∞–ø—Ä–æ—Å–æ–≤)..."

for ((i=1; i<=REQUESTS; i++)); do
    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π URL –∏ IP
    URL=${URLS[$RANDOM % ${#URLS[@]}]}
    IP=${IPS[$RANDOM % ${#IPS[@]}]}

    # –° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 1/5 –¥–æ–±–∞–≤–ª—è–µ–º –æ—à–∏–±–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å
    if (( RANDOM % 5 == 0 )); then
        URL="/nonexistent$(date +%s)"
    fi

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
    curl -s -o /dev/null -w "%{http_code} " \
        -H "X-Forwarded-For: $IP" \
        "$NGINX_URL$URL"

    echo "[$i] $IP ‚Üí $URL"

    sleep "$INTERVAL"
done

echo "‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"